<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>注册</title>
    <link rel="stylesheet" href="css/weui.min.css" />
    <link rel="stylesheet" href="css/jquery-weui.min.css">
    <link rel="stylesheet" href="css/style.css?v=1.1" />
</head>
<body>
<div id="wrap">
    <p style="padding: 10px 10px 0px; color: #999">请输入您的姓名、身份证号等信息，实名认证后即可使用门慢相关服务。</p>
    <div class="weui-cells weui-cells_form">
        <div class="weui-cell">
            <div class="weui-cell__hd"><label class="weui-label">姓名</label></div>
            <div class="weui-cell__bd">
                <input id="name" class="weui-input" placeholder="填写姓名" autocomplete="off" />
            </div>
        </div>
        <div class="weui-cell">
            <div class="weui-cell__hd"><label class="weui-label">身份证号码</label></div>
            <div class="weui-cell__bd">
                <input id="idCode" class="weui-input" placeholder="填写身份证号码" autocomplete="off" maxlength="18" />
            </div>
        </div>
        <div class="weui-cell">
            <div class="weui-cell__hd"><label class="weui-label">手机号</label></div>
            <div class="weui-cell__bd">
                <input id="telephone" class="weui-input" placeholder="填写手机号" autocomplete="off" maxlength="11" />
            </div>
        </div>
    </div>
    <div style="padding: 40px">
        <p style="text-align: center; margin-bottom: 10px; font-size: 16px">
            <label><input type="CheckBox" name="checkbox" id="agree" /> 同意</label> <a href="javascript:;" style="color:#3030ff" id="showAgreement">《用户授权协议》</a>
        </p>
        <a href="javascript:;" class="weui-btn weui-btn_primary" id="regist">注册并认证</a>
    </div>
</div>
<div id="userAgreement" style="display: none; position: fixed; left: 0; right: 0; top: 0; bottom: 0; z-index: 5; background: #fff; padding: 15px">
    <h2 style="text-align: center">用户授权协议</h2>
    <div style="padding: 40px">
        <a href="javascript:" class="weui-btn weui-btn_primary" id="back">返回</a>
    </div>
</div>
<script src="js/jquery.min.js"></script>
<script src="js/jquery-weui.min.js"></script>
<script src="js/common.js?v=1.1"></script>
<script>
    $('#regist').on('click', function(){
        let name = $('#name').val()
        let idCode = $('#idCode').val()
        let telephone = $('#telephone').val()
        let agree = $('#agree').prop("checked")
        if(!name){
            $.toast('姓名不能为空', 'forbidden');
            return
        }
        if(!idCode){
            $.toast('身份证号不能为空', 'forbidden');
            return
        }
        let reg = /^[1-9]\d{5}(?:18|19|20)\d{2}(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d{3}[\dXx]$/;
        if(!reg.test(idCode)){
            $.toast('身份证号格式不正确', 'forbidden');
            return
        }
        
        if(!telephone){
            $.toast('手机号不能为空', 'forbidden');
            return
        }
        let reg2 = /^(?:(?:\+|00)86)?1[3-9]\d{9}$/;
        if(!reg2.test(telephone)){
            $.toast('手机号格式不正确', 'forbidden');
            return
        }
        if(!agree){
            $.toast('请同意用户协议', 'forbidden');
            return
        }
        let registInfo = {
            name,
            idCode,
            telephone
        }
        sessionStorage.setItem('registInfo', JSON.stringify(registInfo))
        window.location.href = 'registAuth.html'
    })

    $('#showAgreement').on('click', () => {
        $('#userAgreement').show()
    })
    $('#back').on('click', () => {
        $('#userAgreement').hide()
    })
</script>
</body> 
</html>